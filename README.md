# **Interlude_PvP_2024**

Base aCis rev. 372

## Fix

* Arreglado el problema de duplicar "items" con "pets".
* Solucionado el problema de duplicar adena multisell,privatestore etc.
* Arreglado Doors in Siege, ahora los atacantes magos pueden romper la puerta,

## Mods

* Agregado OfflineMod.
* Agregado Cambiar tiempo de buff.
* Agregado Event Pc bang.
* Agregado VoicedComand.
* Agregado Auto-Farm.
* Agregado Shift + Click Droplist.
* Agregado Cancel return buff.
* Agregado Clan Full Item.
* Agregado Infinity SS and Arrows.
* Agregado Dynamic PvP Zones.
* Agregado Fake PCs.
* Agregado Custom Effect on die.
* Agregado Multisell Enchant Items Support.
* Agregado A & S grade for PvPs.
* Agregado AntBuffs Shield
* Agregado MultiFunctionZone by Wyat
* Agregado Party Farm Event
* Agregado Event Engine: TvT - CTF - DM.
* Agregado Tournament Event
* Agregado Goldbar to adena - 2 cliks.
* Agregado Nobles 3er Class Change.
* Agregado Remote Class Master Lvl 20-40-76.
* Agregado Dressme + Try Skin.
* Agregado Ranking PvP-Pk Community Board.
* Agregado Rebirth System Community Board.
* Agregado Auction System Community Board.
* Agregado Region Mod Community Board.
* Agregado Clan Mod Community Board.
* Agregado Bonus Weekend.
* Agregado Champions NPCs.
* Agregado City Elpys Event.
* Agregado Random Spawn Boss Event.
* Agregado Title Color According Amount PvP or Pk.
* Agregado Name Color According Amount PvP or Pk.
* Agregado Enchant Abnormal Effect Armor.
* Agregado SpreeKills.
* Agregado SubClass Acumulatives.
* Agregado PvP Reward.
* Agregado Announce Kill Boss.
* Agregado SellBuffs.
* Agregado AntiBot.
* Agregado SystemAio.
* Agregado SystemVip.

## Admin Tools

* Agregado Admin Search Item Id
* Agregado Admin Easy Zone Create
* Agregado Auto Save DataBase
* Agregado Start Super Haste admin.


## NPCs

* Agregado GM-Shop.
* Agregado Gatekeeper Global
* Agregado NpcRanking.
* Agregado NpcClassMaster.
* Agregado NpcTeleporter.
* Agregado NpcBufferScheme.

Hola amigos, aquí les dejo un compilado en el que estoy agregando mods compartidos por la comunidad del L2, sobre una base que ha compartido el desarrollador "Christian" ó "Sarada" de L2jBrasil y que me gustó su trabajo.
La carpeta compartida contiene el servidor y el system.
No se encuentra preconfigurado, solo algunas cosas minimas para que funcionen los mods.

Olá amigos, aqui está uma compilação na qual estou adicionando mods compartilhados pela comunidade L2, em uma base que foi compartilhada pelo desenvolvedor Christian o Sarada do L2jBrasil e que eu gostei do seu trabalho.
A pasta compartilhada contém o servidor e o sistema.
Não está pré-configurado, apenas algumas coisas mínimas para que os mods funcionem.

## Mods

* Agregado OfflineMod.
* Agregado Cambiar tiempo de buff.
* Agregado Event Pc bang.
* Agregado VoicedComand.
* Agregado Auto-Farm.
* Agregado Shift + Click Droplist.
* Agregado Cancel return buff.
* Agregado Clan Full Item.
* Agregado Infinity SS and Arrows.
* Agregado Dynamic PvP Zones.
* Agregado Fake PCs.
* Agregado Custom Effect on die.
* Agregado Multisell Enchant Items Support.
* Agregado A & S grade for PvPs.
* Agregado AntBuffs Shield
* Agregado MultiFunctionZone by Wyat
* Agregado Party Farm Event
* Agregado Event Engine: TvT - CTF - DM.
* Agregado Tournament Event
* Agregado Goldbar to adena - 2 cliks.
* Agregado Nobles 3er Class Change.
* Agregado Remote Class Master Lvl 20-40-76.
* Agregado Dressme + Try Skin.
* Agregado Ranking PvP-Pk Community Board.
* Agregado Rebirth System Community Board.
* Agregado Auction System Community Board.
* Agregado Region Mod Community Board.
* Agregado Clan Mod Community Board.
* Agregado Bonus Weekend.
* Agregado Champions NPCs.
* Agregado City Elpys Event.
* Agregado Random Spawn Boss Event.
* Agregado Title Color According Amount PvP or Pk.
* Agregado Name Color According Amount PvP or Pk.
* Agregado Enchant Abnormal Effect Armor.
* Agregado SpreeKills.
* Agregado SubClass Acumulatives.
* Agregado PvP Reward.
* Agregado Announce Kill Boss.
* Agregado SellBuffs.
* Agregado AntiBot.
* Agregado SystemAio.
* Agregado SystemVip.

## Admin Tools

* Agregado Admin Search Item Id
* Agregado Admin Easy Zone Create
* Agregado Auto Save DataBase
* Agregado Start Super Haste admin.


## NPCs

* Agregado GM-Shop.
* Agregado Gatekeeper Global
* Agregado NpcRanking.
* Agregado NpcClassMaster.
* Agregado NpcTeleporter.
* Agregado NpcBufferScheme.

![alt text](https://i.imgur.com/6oysCTV.png)
![alt text](https://i.imgur.com/tRSjO6T.png)
![alt text](https://i.imgur.com/YeFNntd.png)
![alt text](https://i.imgur.com/VdbB0m6.png)
![alt text](https://i.imgur.com/MDst0Av.png)
![alt text](https://i.imgur.com/1r7g2md.png)
![alt text](https://i.imgur.com/MHvnZio.png)
![alt text](https://i.imgur.com/jLVaRkH.png)
![alt text](https://files.l2jbrasil.com/attachments/monthly_2024_04/image.png.a3cb209d6aa611c9d202f92e89b2f077.png)


Herramientas de utilidad / Ferramentas úteis :

XAMP

Java 17

Enlace a la carpeta de archivos / Link para a pasta de arquivos :

LINK
https://mega.nz/folder/MZQClJLZ#jP3pk4VXqIOTcsUK5n4HaQ



https://www.l2jbrasil.com/topic/147731-datapack-interlude-pvp-2024/

Datapack V.20 Interlude PVP 2024:

## Mods

* Agregado OfflineMod.
* Agregado Cambiar tiempo de buff.
* Agregado Event Pc bang.
* Agregado VoicedComand.
* Agregado Auto-Farm.
* Agregado Shift + Click Droplist.
* Agregado Cancel return buff.
* Agregado Clan Full Item. => Doble Click al Item

Full lvl 8 + Full Skill + 150K de Reputacion, Item ID = "9968" => Configurable en clan propetys
Full lvl 8, Item ID = "9969" => Configurable en clan.propetys
Clan Reputacion, Item ID ="9970" => Configurable en clan.propetys
( ir a la carpeta clan propetys y setear las skilles a nivel 3, yo en mi servidor tengo hasta nivel 4)

* Agregado Noblesse Letters. => Doble Click al Item

Nobless Letters, Item ID = "9971"  => Configurable en player.propetys
* Agregado Kill Barakiel For Noblesse. => Configurable en player.propetys

* Agregado Noblesse 3er Class Change. => Configurable en npc.propetys

* Agregado Infinity SS and Arrows. ( Se Reparo el Bug, que se generaba cuando se desactivaba esta opcion)
* Agregado Dynamic PvP Zones.
* Agregado Fake PCs. ( no Funcional)
* Agregado Custom Effect on die.
* Agregado Multisell Enchant Items Support.
* Agregado D-C-B-A-S grade Armors and Weapons for PvPs.
* Agregado AntBuffs Shield
* Agregado Comando .Menu

Party Refuse
Trade Refuse
Buffs Refuse
Message Refuse
Experience Refuse
Server Info
Raid Info
Auto Farm
Castle Register
Status => Visualiza el status de otros personajes
Inventory => Visualiza el inventorio de otros personajes
Skills => Visualiza el Skilles de otros personajes
* Agregado Comando .RaidInfo
* Agregado Comando .Skills
* Agregado Comando .Status
* Agregado Comando .Inventory
* Agregado Comando .Bossevent
* Agregado Comando .Autofarm

*Agregado Comando .CastleManager

*Agregado Habilitar y Deshabilitar Castillos para los sieges
* Agregado Evento Kill the Raid Boss
* Agregado MultiFunctionZone by Wyat
* Agregado Party Farm Event
* Agregado Event Engine: TvT - CTF - DM.
* Agregado Tournament Event
* Agregado Goldbar to Adena - 2 cliks.
* Agregado Adena to Goldbar - 2 cliks.
* Agregado Remote Class Master Lvl 20-40-76.
* Agregado Dressme + Try Skin.
* Agregado Ranking PvP-Pk Community Board.
* Agregado Rebirth System Community Board.
* Agregado Auction System Community Board.
* Agregado Region Mod Community Board.
* Agregado Clan Mod Community Board.
* Agregado Bonus Weekend.
* Agregado Champions NPCs.

Champions Week => BonusWeakExp/Sp/Adenas, Configurable en engine/champions.propetys
Champions Super => BonusSuperExp/Sp/Adenas, Configurable en engine/champions.propetys
Champions Hard => BonusHardExp/Sp/Adenas, Configurable en engine/champions.propetys
* Agregado City Elpys Event. (Corrigio el Reward del Evento).
* Agregado Random Spawn Boss Event.
* Agregado Title Color According Amount PvP or Pk.
* Agregado Name Color According Amount PvP or Pk.
* Agregado Enchant Abnormal Effect Armor.

Se modifico el effecto de Enchant Abnormal Effect Armor y se le agrego que cuando subas todo el set al enchant que ustedes configuren +16 o +25 eso a eleccion de cada uno los convierta en Hero con skilles y aura y cuando se saquen alguna parte del set dejan de ser Hero.
* Agregado SpreeKills.
* Agregado SubClass Acumulatives.
* Agregado Habilitar SubClass de Overlord, Warsmith, Dark Elf, Elf
* Agregado Habilitar tirar SubClass con cualquier Villamaster
* Agregado PvP Reward.
* Agregado Announce Kill Boss.
* Agregado SellBuffs.
* Agregado AntiBot.
* Agregado SystemAio.

//setaio + Days => Configurable en engine/aio.propetys
Aio Coin 7 Day, Item ID="9976"
Aio Coin 15 Day, Item ID="9977"
Aio Coin 30 Day, Item ID="9978"
* Agregado SystemVip.

//setvip + Days => Configurable en engine/vip.propetys
VIp Coin 1 Day, Item ID="9972"
VIp Coin 7 Day, Item ID="9973"
VIp Coin 15 Day, Item ID="9974"
VIp Coin 30 Day, Item ID="9975"
* Agregado Setear Max AtkSpd and Max Casting Spd.
* Agregado Starter Item para personajes nuevos.
* Modificado la Quest 508 de Reputacion de clan mas RaidBoss a la quest y subiendo la reputacion que da como reward.
* Modificado la Quest 509 de Prestigio de clan mas RaidBoss a la quest y subiendo la reputacion que da como reward.
* Agregado El Grand Boss Zaken.
* Agregado Formato de Buff inicial para guerreros y magos.
* Agregado Enchant Sytem.


## Admin Tools

* Agregado Admin Search Item Id
* Agregado Admin Easy Zone Create
* Agregado Auto Save DataBase
* Agregado Start Super Haste admin.


## NPCs

* Agregado GM-Shop.
* Agregado Gatekeeper Global
* Agregado NpcRanking.
* Agregado NpcClassMaster.
* Agregado NpcTeleporter.
* Agregado Npc Buffer.

NpcBuffer ID= 60012 => Con buff normales sin enchant => se configura mediante eclipse los precios
NpcBuffer ID= 60013 => Con buff normales enchant time +15 => se configura mediante eclipse los precios
NpcBuffer ID= 60014 => Con buff normales enchant time +30 => se configura mediante eclipse los precios
( Hay Skilles que van a tener que crear el enchant +15 o +30 como Chant of victory y las Profesias, eso lo hacen desde el xml/skill)

Actualizaciones:

* Se Arreglo la Skillid=444 el Festival Sweeper, que no funcionaba como debia.
* Se Arreglo los Heal con Blessed e Spirishot que no funcionaban cuando curaba.
* Se Arreglo el Heal de los Raid Bosses.
* Se Arreglo un bug de skilles iniciales, que hacia que la skill 1177 y a skill 1001 bajaran siempre a nivel 1 cuando desloguiabas el personaje, creando un id 9115 para el inicio de las classes mago y orc mystic, dejare la estructura mas abajo.

*Se Agrego el archivo modsCustomIcons situado en gameserver/data/xml con este archivo podran visualizar cualquier icon skill que no corresponda a la cronica y se lo quieran agregar al npc buffer antes mencionado.

se Agrego en el archivo ClanSkill situado en gameserver/data/xml/skilltrees/clanSkill  itemCount="3" asi podran ponerle la cantidad de items que pedira para aprender dicha skill

Antes:

<clanSkill id="370" lvl="1" cost="5000" minLvl="5" itemId="8164"/><!-- Clan Vitality -->

Despues:

<clanSkill id="370" lvl="1" cost="5000" minLvl="5" itemId="8164" itemCount="3" /><!-- Clan Vitality -->

CODIGO FUENTE LINK : https://www.mediafire.com/file/qgqfz2x90ke7vy6/Interlude_PvP_2024-MainV20.rar/file

COMPILADO V20: https://www.mediafire.com/file/a19rkolck927haq/V20.rar/file

Diff activar fake players

diff --git a/aCis_gameserver/java/enginemods/engine/mods/FakePlayer.java b/aCis_gameserver/java/enginemods/engine/mods/FakePlayer.java
index a7db2526..e8c33c7b 100644
--- a/aCis_gameserver/java/enginemods/engine/mods/FakePlayer.java
+++ b/aCis_gameserver/java/enginemods/engine/mods/FakePlayer.java
@@ -102,7 +102,7 @@ public class FakePlayer extends AbstractMods
public FakePlayer()
{
// Desabilitado hasta q estemos seguro de q funcione correctamente
-		// registerMod(ConfigData.ENABLE_fakePlayers);
+		 registerMod(ConfigData.ENABLE_fakePlayers);
     }

diff --git a/aCis_gameserver/java/enginemods/util/UtilPlayer.java b/aCis_gameserver/java/enginemods/util/UtilPlayer.java
index 5d589f19..195bc09d 100644
--- a/aCis_gameserver/java/enginemods/util/UtilPlayer.java
+++ b/aCis_gameserver/java/enginemods/util/UtilPlayer.java
@@ -41,7 +41,8 @@
public class UtilPlayer
{
private static final String CREATE_ACCOUNTS = "INSERT INTO accounts (login, password, lastactive, access_level) values (?, ?, ?, ?)";
-	private static final String UPDATE_CHARACTER = "UPDATE characters SET level=?,maxHp=?,curHp=?,maxCp=?,curCp=?,maxMp=?,curMp=?,face=?,hairStyle=?,hairColor=?,sex=?,heading=?,x=?,y=?,z=?,exp=?,expBeforeDeath=?,sp=?,karma=?,pvpkills=?,pkkills=?,rec_have=?,rec_left=?,clanid=?,race=?,classid=?,deletetime=?,title=?,accesslevel=?,online=?,isin7sdungeon=?,clan_privs=?,wantspeace=?,base_class=?,onlinetime=?,punish_level=?,punish_timer=?,nobless=?,power_grade=?,subpledge=?,last_recom_date=?,lvl_joined_academy=?,apprentice=?,sponsor=?,varka_ketra_ally=?,clan_join_expiry_time=?,clan_create_expiry_time=?,char_name=?,death_penalty_level=? WHERE obj_id=?";
+	private static final String UPDATE_CHARACTER = "UPDATE characters SET level=?,maxHp=?,curHp=?,maxCp=?,curCp=?,maxMp=?,curMp=?,face=?,hairStyle=?,hairColor=?,sex=?,heading=?,x=?,y=?,z=?,exp=?,expBeforeDeath=?,sp=?,karma=?,pvpkills=?,pkkills=?,clanid=?,race=?,classid=?,deletetime=?,title=?,accesslevel=?,online=?,isin7sdungeon=?,clan_privs=?,wantspeace=?,base_class=?,onlinetime=?,punish_level=?,punish_timer=?,nobless=?,power_grade=?,subpledge=?,lvl_joined_academy=?,apprentice=?,sponsor=?,varka_ketra_ally=?,clan_join_expiry_time=?,clan_create_expiry_time=?,char_name=?,death_penalty_level=?,pc_point=? WHERE obj_id=?";

 	private static final ReentrantLock _locker = new ReentrantLock();

@@ -183,36 +184,34 @@ public static void storeCharBase(Player player)
statement.setInt(18, sp);
statement.setInt(19, player.getKarma());
statement.setInt(20, player.getPvpKills());
-			statement.setInt(21, player.getPkKills());
-			statement.setInt(22, player.getRecomHave());
-			statement.setInt(23, player.getRecomLeft());
-			statement.setInt(24, player.getClanId());
-			statement.setInt(25, player.getRace().ordinal());
-			statement.setInt(26, player.getClassId().getId());
-			statement.setLong(27, player.getDeleteTimer());
-			statement.setString(28, player.getTitle());
-			statement.setInt(29, player.getAccessLevel().getLevel());
-			statement.setInt(30, player.isOnlineInt());
-			statement.setInt(31, player.isIn7sDungeon() ? 1 : 0);
-			statement.setInt(32, player.getClanPrivileges());
-			statement.setInt(33, player.wantsPeace() ? 1 : 0);
-			statement.setInt(34, player.getBaseClass());
-			statement.setLong(35, 0);
-			statement.setInt(36, player.getPunishLevel().value());
-			statement.setLong(37, player.getPunishTimer());
-			statement.setInt(38, player.isNoble() ? 1 : 0);
-			statement.setLong(39, player.getPowerGrade());
-			statement.setInt(40, player.getPledgeType());
-			statement.setLong(41, player.getRecomHave());//getLastRecomUpdate());
-			statement.setInt(42, player.getLvlJoinedAcademy());
-			statement.setLong(43, player.getApprentice());
-			statement.setLong(44, player.getSponsor());
-			statement.setInt(45, player.getAllianceWithVarkaKetra());
-			statement.setLong(46, player.getClanJoinExpiryTime());
-			statement.setLong(47, player.getClanCreateExpiryTime());
-			statement.setString(48, player.getName());
-			statement.setLong(49, player.getDeathPenaltyBuffLevel());
-			statement.setInt(50, player.getObjectId());
+			statement.setInt(21, player.getPkKills());			
+			statement.setInt(22, player.getClanId());
+			statement.setInt(23, player.getRace().ordinal());
+			statement.setInt(24, player.getClassId().getId());
+			statement.setLong(25, player.getDeleteTimer());
+			statement.setString(26, player.getTitle());
+			statement.setInt(27, player.getAccessLevel().getLevel());
+			statement.setInt(28, player.isOnlineInt());
+			statement.setInt(29, player.isIn7sDungeon() ? 1 : 0);
+			statement.setInt(30, player.getClanPrivileges());
+			statement.setInt(31, player.wantsPeace() ? 1 : 0);
+			statement.setInt(32, player.getBaseClass());			
+			statement.setLong(33, 0);
+			statement.setInt(34, player.getPunishLevel().value());
+			statement.setLong(35, player.getPunishTimer());
+			statement.setInt(36, player.isNoble() ? 1 : 0);
+			statement.setLong(37, player.getPowerGrade());
+			statement.setInt(38, player.getPledgeType());						
+			statement.setInt(39, player.getLvlJoinedAcademy());
+			statement.setLong(40, player.getApprentice());
+			statement.setLong(41, player.getSponsor());
+			statement.setInt(42, player.getAllianceWithVarkaKetra());
+			statement.setLong(43, player.getClanJoinExpiryTime());
+			statement.setLong(44, player.getClanCreateExpiryTime());
+			statement.setString(45, player.getName());
+			statement.setLong(46, player.getDeathPenaltyBuffLevel());
+			statement.setInt(47, player.getPcBangScore());
+			statement.setInt(48, player.getObjectId());
     		
     		statement.execute();
     		statement.close();


NOTA:


+ Es necesario arreglar (devolver algun dato para los fake) el admioncommanhandler AdminEditChar: -> ( sino devolvera un warning al no recuperar los datos )
  final String account = clientInfo.substring(clientInfo.indexOf("Account:") + 9, clientInfo.indexOf(" - IP: "));
  final String ip = clientInfo.substring(clientInfo.indexOf(" - IP: ") + 7, clientInfo.lastIndexOf("]"));
